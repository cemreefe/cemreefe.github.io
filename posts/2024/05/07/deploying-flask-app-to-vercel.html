<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cemrekarakas.com/static/css/theme.css">
    <link rel="icon" type="image/png" href="https://emoji.dutl.uk/png/64x64/üßëüèª‚Äçüíª.png">
    <title>Flask app on Vercel for Free (How to?) - Cemre's Blog</title>
    
    <meta property="og:title" name="title" content="Flask app on Vercel for Free (How to?)" />
    <meta property="og:image" name="image" content="https://cemrekarakas.com/posts/2024/05/07/flask-on-vercel.png" />
    <meta property="og:description" name="description" content="How to deploy your flask app to Vercel? First a short intro; if you know what vercel is and why you want to deploy your project to vercel, skip here." />
    <meta property="og:type" content="website" />
    <meta property="og:url" name="url" content="https://cemrekarakas.com/posts/2024/05/07/deploying-flask-app-to-vercel">
    <meta property="twitter:title" name="title" content="Flask app on Vercel for Free (How to?)" />
    <meta property="twitter:image" name="image" content="https://cemrekarakas.com/posts/2024/05/07/flask-on-vercel.png" />
    <link rel="canonical" href="https://cemrekarakas.com/posts/2024/05/07/deploying-flask-app-to-vercel" />
    <meta property="og:pubdate" name="pubdate" content="Tue, 07 May 2024 00:00:00 +0000" />

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D53MYFV2RS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D53MYFV2RS');
</script>
<script>
  // Function to handle the click event on headers.
  function handleClick(event) {
      // Get the element's ID.
      const id = this.id;

      // Define the base URL.
      const baseUrl = window.location.href.split('#')[0];

      // Construct the URL with ID.
      const urlWithId = baseUrl + '#' + id;

      // Create a temporary text area element to facilitate copying to the clipboard.
      const textArea = document.createElement('textarea');
      textArea.value = urlWithId;
      document.body.appendChild(textArea);

      // Select and copy the URL with ID to the clipboard.
      textArea.select();
      document.execCommand('copy');

      // Remove the temporary text area element.
      document.body.removeChild(textArea);

      alert("Link copied to clipboard.");
  }

  // Add a DOMContentLoaded event listener to run the code when the document is ready.
  document.addEventListener('DOMContentLoaded', function() {
      // Add a click event listener to the specified header elements (h2, h3, h4).
      document.querySelectorAll('h2, h3, h4').forEach(function(header) {
          header.addEventListener('click', handleClick);
      });
  });
</script>

<p><meta name="twitter:card" content="summary_large_image"/>
<meta content='@cemreefe' name='twitter:site'/>
<meta content='@cemreefe' name='twitter:creator'/></p>
<script>
    // temporary script for applying custom styles
    function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }

    function switchStylesheet(newHref) {
        // Get all current link elements in the head
        const links = document.querySelectorAll('link[rel=stylesheet]');

        // Loop through the link elements and remove them
        links.forEach(link => {
            link.parentNode.removeChild(link);
        });

        // Create a new link element for the new stylesheet
        const newLink = document.createElement('link');
        newLink.rel = 'stylesheet';
        newLink.href = newHref;

        // Append the new link element to the head
        document.head.appendChild(newLink);
    }

    function addStyleParamToLinks(style) {
        const links = document.querySelectorAll('a[href]');
        links.forEach(link => {
            const url = new URL(link.href);
            url.searchParams.set('style', style);
            link.href = url.toString();
        });
    }

    // On page load, check for the 'style' query parameter and apply style
    window.addEventListener('DOMContentLoaded', () => {
        const style = getQueryParam('style');
        if (style) {
            const stylesheetHref = `/static/css/${style}.css`;
            switchStylesheet(stylesheetHref);
            addStyleParamToLinks(style);
        }
    });
</script>
  </head>
  <body>
    <div class="wrapper">
      <div class="content">
        <nav>
          <h3 id="cemre-efe-karakas">Cemre Efe Karakas</h3>
<p> §em…æe efe ka…æaka É</p>
<p><a href="/">About</a>
<a href="/blog">Blog</a>
<a href="/contact">Contact</a>
<a href="/archive">Archive</a>
<a href="/search">üîç</a></p>
<hr />
        </nav>
      </div>
      <div class="content">
        <main>
          
          <div class="categoryTag">
            software
          </div>
          
          <div class="categoryTag">
            coding
          </div>
          
          <h1 id="host-flask-app-on-vercel-for-free">Host Flask app on Vercel for Free</h1>
<p><img alt="Vercel logo" src="https://cemrekarakas.com/posts/2024/05/07/vercel-banner.png"/></p>
<p>How to deploy your flask app to Vercel? First a short intro; if you know what vercel is and why you want to deploy your project to vercel, <a href="#okay-how-do-i-deploy-my-flask-app-to-vercel-then">skip here</a>.</p>
<h2 id="what-is-vercel">What is Vercel?</h2>
<p>Most people know Vercel as a front-end solution, however Vercel introduced many new features recently that make it a powerful tool for running small webapps <strong>for free</strong>.</p>
<p>Vercel is a platform that enables developers to build, deploy, and manage modern web applications. Having tested it myself, I can vouch for the fact that once integrated, it is quite simple to use. With Vercel, developers can simply push their changes to their GitHub repository, and the platform will automatically redeploy the site and update the server with the new code (CI/CD Anyone?). The platform also provides a dashboard for each site, offering insights into status, recent deploys, and domain information. </p>
<p><img alt="Vercel dashboard example showing live preview, domains, settings" src="https://cemrekarakas.com/posts/2024/05/07/vercel-dashboard.png"/></p>
<p>Contrary to many other services, custom domains on Vercel can be configured for free. Additional features like insights dashboard, traffic, acquisition etc. are paid features. However, if you're like me, meaning you like developing small web applications that are fine to be constrained by free-tier limitations (see table below), then Vercel is a great solution for you.</p>
<h2 id="whats-the-catch">Whats the catch?</h2>
<p>Vercel's business model mostly revolves around frontend applications, thus most of what they are offering on <strong>free tier is valid for serverless applications</strong>. While the frontend applications can access compute on its own, they <strong>do not have access to persistent memory</strong>. </p>
<p>Your python Vercel applications can only create/upload/edit files in the <code>/tmp/</code> directory. This directory is cleaned up during each deployment, and additionally after a while when you app is '<em>dormant</em>' that is, not serving any requests for a while. You can bypass this restriction if you subscribe to a paid plan.</p>
<p>This won't be a problem if (1) you don't need persistent storage, and (2) if your app doesn't write to the database and works on reads only.</p>
<p>So what is Vercel free-tier good for if it can not support a database write? Well, there are a lot of stateless applications that you could implement using flask and deploy to vercel. Simple games, simple services like convertors, userless GenAI applications etc. And this guide will be applicable to applications of the sort. If your application needs a database albeit volatile, you can have one in <code>tmp</code>, or if small enough, in memory.</p>
<p>If you're only ever going to read from your database, you can commit your database to your git repo and use it as usual.</p>
<table>
<thead>
<tr>
<th>‚ñ≤</th>
<th>Hobby</th>
<th>Pro</th>
<th>Enterprise</th>
</tr>
</thead>
<tbody>
<tr>
<td>Projects</td>
<td>200</td>
<td>Unlimited</td>
<td>Unlimited</td>
</tr>
<tr>
<td>Deployments Created per Day</td>
<td>100</td>
<td>6000</td>
<td>Custom</td>
</tr>
<tr>
<td>Serverless Functions Created per Deployment</td>
<td><a href="https://vercel.com/docs/functions/serverless-functions/runtimes#functions-created-per-deployment">Framework-dependent*</a></td>
<td>‚àû</td>
<td>‚àû</td>
</tr>
<tr>
<td><a href="https://vercel.com/docs/limits/overview#proxied-request-timeout">Proxied Request Timeout¬†</a>(Seconds)</td>
<td>30</td>
<td>30</td>
<td>30</td>
</tr>
<tr>
<td>Deployments Created from CLI per Week</td>
<td>2000</td>
<td>2000</td>
<td>Custom</td>
</tr>
<tr>
<td><a href="https://vercel.com/docs/limits/overview#connecting-a-project-to-a-git-repository">Vercel Projects Connected per Git Repository</a></td>
<td>3</td>
<td>60</td>
<td>Custom</td>
</tr>
<tr>
<td><a href="https://vercel.com/docs/limits/overview#routes-created-per-deployment">Routes created per Deployment</a></td>
<td>1024</td>
<td>1024</td>
<td>Custom</td>
</tr>
<tr>
<td><a href="https://vercel.com/docs/limits/overview#build-time-per-deployment">Build Time per Deployment</a>(Minutes)</td>
<td>45</td>
<td>45</td>
<td>45</td>
</tr>
<tr>
<td><a href="https://vercel.com/docs/deployments/concurrent-builds">Concurrent Builds</a></td>
<td>1</td>
<td>12</td>
<td>Custom</td>
</tr>
<tr>
<td>Disk Size (GB)</td>
<td>13</td>
<td>13</td>
<td>13</td>
</tr>
<tr>
<td>Cron Jobs</td>
<td><a href="https://vercel.com/docs/cron-jobs/usage-and-pricing">2*</a></td>
<td>40</td>
<td>100</td>
</tr>
</tbody>
</table>
<p>For more, read on their blog <a href="https://vercel.com/blog/what-is-vercel"># What does Vercel do?</a>.</p>
<h2 id="okay-how-do-i-deploy-my-flask-app-to-vercel-then">Okay, how do I deploy my flask app to Vercel then?</h2>
<p>This is assuming you already have a Flask app up &amp; running in your local. If not, go to <a href="https://vercel.com/templates/python/flask-hello-world"># Vercel: Flask Hello World</a>.</p>
<h3 id="1-directory-structure">1. Directory Structure</h3>
<p>Okay, you have your Flask app, and presumably, it looks something like this:</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>--$ git(mainline)--
my-flask-app/
‚îú‚îÄ app.py
‚îú‚îÄ helpers/
‚îÇ  ‚îú‚îÄ some_helpers.py
‚îÇ  ‚îú‚îÄ other_helpers.py
‚îú‚îÄ static/
‚îÇ  ‚îú‚îÄ favicon.ico
‚îÇ  ‚îú‚îÄ styles.css
‚îú‚îÄ templates/
‚îÇ  ‚îú‚îÄ index.html
‚îú‚îÄ .gitignore
‚îú‚îÄ README.md
</code></pre></div>
<p>Let's create a new branch from HEAD, and form our new directory mapping for Vercel.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #666666">--</span><span style="border: 1px solid #FF0000">$</span><span style="color: #bbbbbb"> </span>git(vercel<span style="color: #666666">-</span>mainline)<span style="color: #666666">--</span>
my<span style="color: #666666">-</span>flask<span style="color: #666666">-</span>app<span style="color: #666666">/</span>
<span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">api</span><span style="color: #666666">/</span>
<span style="color: #666666">|</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>index.py<span style="color: #bbbbbb"> </span><span style="border: 1px solid #FF0000">#</span><span style="color: #bbbbbb"> </span>renamed<span style="color: #bbbbbb"> </span>from<span style="color: #bbbbbb"> </span>app.py
<span style="color: #666666">|</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>static<span style="color: #666666">/</span>
<span style="color: #666666">|</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îÇ</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>favicon.ico
<span style="border: 1px solid #FF0000">‚îÇ</span><span style="color: #bbbbbb">  </span><span style="color: #666666">|</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>styles.css
<span style="color: #666666">|</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>templates<span style="color: #666666">/</span>
<span style="color: #666666">|</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îÇ</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>index.html
<span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>helpers<span style="color: #666666">/</span>
<span style="border: 1px solid #FF0000">‚îÇ</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>some_helpers.py
<span style="border: 1px solid #FF0000">‚îÇ</span><span style="color: #bbbbbb">  </span><span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>other_helpers.py
<span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>vercel.json
<span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span><span style="color: #008000; font-weight: bold">package</span>.json
<span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>.gitignore
<span style="border: 1px solid #FF0000">‚îú‚îÄ</span><span style="color: #bbbbbb"> </span>README.md
</code></pre></div>
<p>Where <code>vercel.json</code> looks like the following, which dicatates your flask app's path from root. This snippet means that any request to your site, regardless of the path, will be rewritten to /api/index. This is useful when you have a single-page application or when you want to route all requests to a specific Serverless Function.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>{
  "rewrites": [
    { "source": "/(.*)", "destination": "/api/index" }
  ]
}
</code></pre></div>
<p>P.S. Your <code>index.py</code> will be able to import packages as if it was at the root in this structure. No code changes required for this directory structure change.</p>
<p>And package.json looks like the following, and sets the node.js version to be used by Vercel. Vercel has a few supported versions, go to their documentation to see which versions are supported.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>{
  "engines": {
    "node": "18.x"
  }
}
</code></pre></div>
<h3 id="2-create-a-vercel-account-and-connect-your-repositoy">2. Create a Vercel account and connect your repositoy</h3>
<p>Create a Vercel account, go to Projects &gt; Import and connect your Vercel account to your github account to get access to your public or private repositories. Choose the repository of your flask app, choose <code>vercel-mainline</code> as the target branch and import your project.</p>
<p><img alt="Vercel view priompting user to import a project via github" src="https://cemrekarakas.com/posts/2024/05/07/vercel-import.png"/></p>
<p>After importing your project, vercel will attempt your initial deployment. At this point, the deployment should succeed given your repository is in the correct organizational structure introduced in (1). Congratulations, your app is up &amp; running at <code>&lt;app-name&gt;.vercel.app</code>.</p>
<h3 id="3-environment-variables">3. Environment variables</h3>
<p>Vercel lets you define an arbitrary number of environment variables. What I like to do is running my apps on my local in debug mode. So I add the following if-else block into my main definition, and define a VERCEL environment variable.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>if __name__ == '__main__':
    if os.environ.get('VERCEL', None):
        app.run(debug=False)
    else:
        app.run(debug=True)
</code></pre></div>
<p><img alt="Environment variables view on Vercel" src="https://cemrekarakas.com/posts/2024/05/07/vercel-environment-variables.png"/></p>
<h3 id="4-setting-up-a-volatile-database">4. Setting up a volatile database</h3>
<p>If your app needs a database to run. Let's reiterate on the fact that Vercel does not provide any persistent data storage for your app on its free tier. But if you need a volatile database to execute tasks, you can set up your database to live on the <code>/tmp/</code> directory, or completely in memory;</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #19177C">conn</span><span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #19177C">sqlite3</span>.<span style="color: #008000; font-weight: bold">connect</span><span style="color: #19177C">(</span><span style="color: #BA2121">'/tmp/test.db'</span><span style="color: #19177C">)</span>
#<span style="color: #bbbbbb"> </span><span style="color: #19177C">or</span>
<span style="color: #19177C">conn</span><span style="color: #bbbbbb"> </span><span style="color: #666666">=</span><span style="color: #bbbbbb"> </span><span style="color: #19177C">sqlite3</span>.<span style="color: #008000; font-weight: bold">connect</span><span style="color: #19177C">(</span><span style="color: #BA2121">':memory:'</span><span style="color: #19177C">)</span>
</code></pre></div>
<h2 id="conclusion">Conclusion</h2>
<p>This is how to get your already existing flask app running on Vercel in no time. If you have any comments, recommendations or trouble following the steps here. Please feel free to reach out üëá</p>
<p>Reply on
- <a href="mailto:cemrekr@aol.com">email</a>
- <a href="https://mastodon.social/@cemre">mastodon</a></p>
<div class="commentbox"></div>
<script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
<script>commentBox('5631895295492096-proj')</script>
<div onclick="{window.open('https://twitter.com/intent/tweet?url=Check out this \''+ document.getElementsByTagName('h1')[0].innerHTML +'\' article on Cemre\'s Blog: '+window.location.href, '_blank');}" style="
    position: fixed;
    bottom: 0;
    right: 1em;
    cursor: pointer;">
<img alt="Share to Twitter" src="https://cemrekarakas.com/static/img/twitter-100.png" style="width: 5em;"/>
</div>
        </main>
      </div>
      <footer>
        <p>2023 - Created with <a href="https://github.com/cemreefe/SimplyMarkdown">SimplyMarkdown</a></p>
<script>
  document.addEventListener('DOMContentLoaded', function() {
      // Get the current page's URL
      var currentPageURL = window.location.href;

      // Select all anchor elements on the page
      var links = document.querySelectorAll('a');

      // Loop through each link
      links.forEach(function(link) {
          // Check if the href of the link matches the current page's URL
          if (link.href === currentPageURL) {
              // Change the color of the link to red
              link.style.color = 'red';
          }
      });
  });
</script>
      </footer>
    </div>
  </body>
</html>