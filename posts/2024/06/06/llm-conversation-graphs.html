<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cemrekarakas.com/static/css/theme.css">
    <link rel="icon" type="image/png" href="https://emoji.dutl.uk/png/64x64/üå†.png">
    <title>Graph managed LLM conversations - concept - Cemre's Blog</title>
    
    <meta property="og:title" name="title" content="Graph managed LLM conversations - concept" />
    <meta property="og:image" name="image" content="https://cemrekarakas.com/posts/2024/06/06/cherry-blossoms-in-blue.png" />
    <meta property="og:description" name="description" content="Ever felt frustrated when a chatbot loses context after you explore a side topic? Current LLM (Large Language Model) conversation models are limited by the..." />
    <meta property="og:type" content="website" />
    <meta property="og:url" name="url" content="https://cemrekarakas.com/posts/2024/06/06/llm-conversation-graphs">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Graph managed LLM conversations - concept">
    <meta name="twitter:description" content="Ever felt frustrated when a chatbot loses context after you explore a side topic? Current LLM (Large Language Model) conversation models are limited by the...">
    <meta name="twitter:image" content="https://cemrekarakas.com/posts/2024/06/06/cherry-blossoms-in-blue.png">
    <link rel="canonical" href="https://cemrekarakas.com/posts/2024/06/06/llm-conversation-graphs" />
    <meta property="og:pubdate" name="pubdate" content="Thu, 06 Jun 2024 00:00:00 +0000" />
    
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D53MYFV2RS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D53MYFV2RS');
</script>
<script>
  // Function to handle the click event on headers.
  function handleClick(event) {
    // Get the element's ID.
    const id = this.id;

    // Define the base URL.
    const baseUrl = window.location.href.split('#')[0];

    // Construct the URL with ID.
    const urlWithId = baseUrl + '#' + id;

    // Update the browser's URL without reloading the page.
    window.history.pushState(null, null, urlWithId);

    // Scroll to the element with the specified ID.
    document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
  }

  // Add a DOMContentLoaded event listener to run the code when the document is ready.
  document.addEventListener('DOMContentLoaded', function() {
      // Add a click event listener to the specified header elements (h2, h3, h4).
      document.querySelectorAll('h2, h3, h4').forEach(function(header) {
          header.addEventListener('click', handleClick);
      });
  });
</script>

<p><meta content='@cemreefe' name='twitter:site'/>
<meta content='@cemreefe' name='twitter:creator'/></p>
<script>
    // temporary script for applying custom styles
    function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }

    function switchStylesheet(newHref) {
        // Get all current link elements in the head
        const links = document.querySelectorAll('link[rel=stylesheet]');

        // Loop through the link elements and remove them
        links.forEach(link => {
            link.parentNode.removeChild(link);
        });

        // Create a new link element for the new stylesheet
        const newLink = document.createElement('link');
        newLink.rel = 'stylesheet';
        newLink.href = newHref;

        // Append the new link element to the head
        document.head.appendChild(newLink);
    }

    function addStyleParamToLinks(style) {
        const links = document.querySelectorAll('a[href]');
        links.forEach(link => {
            const url = new URL(link.href);
            url.searchParams.set('style', style);
            link.href = url.toString();
        });
    }

    // On page load, check for the 'style' query parameter and apply style
    window.addEventListener('DOMContentLoaded', () => {
        const style = getQueryParam('style');
        if (style) {
            const stylesheetHref = `/static/css/${style}.css`;
            switchStylesheet(stylesheetHref);
            addStyleParamToLinks(style);
        }
    });
</script>

<!-- Highlight current page in navbar -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
      // Get the current page's URL
      var currentPageURL = window.location.href;

      // Select all anchor elements on the page
      var links = document.querySelectorAll('a');

      // Loop through each link
      links.forEach(function(link) {
          // Check if the href of the link matches the current page's URL
          if (link.href === currentPageURL) {
              // Change the color of the link to red
              link.style.color = 'red';
          }
      });
  });
</script>
  </head>
  <body>
    <div class="wrapper">
      <div class="content">
        <nav>
          <h3 id="cemre-efe-karakas">Cemre Efe Karakas</h3>
<p><a href="/">About</a>
<a href="/blog">Blog</a>
<a href="/contact">Contact</a>
<a href="/archive">Archive</a>
<a href="/search">üîç</a>
<a href="/rss.xml">RSS</a></p>
<hr />
        </nav>
      </div>
      <div class="content">
        <main>
          
          <div class="categoryTag">
            software
          </div>
          
          <div class="categoryTag">
            llm
          </div>
          
          <div class="categoryTag">
            concept
          </div>
          
          <h1 id="managing-llm-conversations-using-a-graph-structure">Managing LLM Conversations Using a Graph Structure</h1>
<p><img alt="Cherry blossoms in blue by Van Gogh, depicting a cherry blossom branch with its many branchettes." src="https://cemrekarakas.com/posts/2024/06/06/cherry-blossoms-in-blue.png"/></p>
<h2 id="introduction">Introduction</h2>
<p>Ever felt frustrated when a chatbot loses context after you explore a side topic? Current LLM (Large Language Model) conversation models are limited by their linear structure, which hinders context preservation and flexibility in branching and merging conversations. To overcome this, I propose a graph-managed LLM conversation approach, allowing for broader discussions with specific side topics while maintaining the full context.</p>
<h2 id="setting-the-glossary">Setting the Glossary</h2>
<h3 id="the-conversation-node">The Conversation Node</h3>
<p>In human-LLM conversations, the basic building block is a <strong>question-answer (or input-output) pair</strong>. We‚Äôll refer to this as a conversation node.</p>
<p><img alt="A conversation node, input and output pair" src="https://cemrekarakas.com/posts/2024/06/06/1-conversation-node.png"/></p>
<h3 id="conversation-history">Conversation History</h3>
<p>A <strong>sequence of conversation nodes</strong> forms a conversation history. This history can be authentic (real input-output pairs) or fabricated (synthetic data).</p>
<p><img alt="A sequence of conversation nodes" src="https://cemrekarakas.com/posts/2024/06/06/2-conversation-history.png"/></p>
<h3 id="transforming-conversation-history-into-api-input">Transforming Conversation History into API Input</h3>
<p>The sequence of conversation nodes is typically converted into a JSON format to be used as input for an LLM API. This process is open to manipulation.</p>
<p><img alt="Conversion of conversation history to llm input, a sequence of nodes and the corresponding json structure (pseudocode)" src="https://cemrekarakas.com/posts/2024/06/06/3-llm-input.png"/></p>
<h3 id="branching-conversations">Branching Conversations</h3>
<p>When branching off from an earlier node, the context from the existing branch is often lost, which is expected. However, exploring new concepts in a new branch can be useful. Eventually, you might want to return to the main conversation, but its context remains isolated from the current branch.</p>
<p><img alt="Branching off and losing context" src="https://cemrekarakas.com/posts/2024/06/06/4-branching-off.png"/></p>
<p><img alt="Conversation ongoing in two branches" src="https://cemrekarakas.com/posts/2024/06/06/5-two-branches-contd.png"/></p>
<h2 id="proposal">Proposal</h2>
<h3 id="merging-priorities">Merging Priorities</h3>
<p>To merge two or more branches back into a single conversation, the order of merging is crucial as it affects the LLM‚Äôs context. Users should have the ability to specify the order of merging, effectively setting the priority of each branch.</p>
<p><img alt="Merging branches with priorities" src="https://cemrekarakas.com/posts/2024/06/06/6-merging-priorities.png"/></p>
<h3 id="background-summarization-and-prompt-compression">Background Summarization and Prompt Compression</h3>
<p>During the merging of branches, the LLM may have too much context to consider. To manage this, techniques such as background summarization can rebase the deprioritized branch closer to the prioritized one. Prompt compression, like the LLMLingua method, can also help manage the context effectively.</p>
<p><img alt="Background summarization and prompt compression" src="https://cemrekarakas.com/posts/2024/06/06/7-background-summarization.png"/></p>
<h2 id="conclusion">Conclusion</h2>
<p>Graph-managed LLM conversations enable broader discussions with specific side topics while maintaining full context, much like human-to-human conversations. This approach improves the context-awareness of LLM agents, allowing for more precise and in-depth discussions.</p>
<p>By adopting graph-managed conversations, you can explore various topics in depth without losing context, ultimately enhancing your interaction with LLMs. I am yet implement this as an MVP but feel free to experiment with this approach and share your experiences! </p>
<p>Reply on
- <a href="mailto:cemrekr@aol.com">email</a>
- <a href="https://mastodon.social/@cemre">mastodon</a></p>
<div class="commentbox"></div>
<script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
<script>commentBox('5631895295492096-proj')</script>
<div onclick="{window.open('https://twitter.com/intent/tweet?url=Check out this \''+ document.getElementsByTagName('h1')[0].innerHTML +'\' article on Cemre\'s Blog: '+window.location.href, '_blank');}" style="
    position: fixed;
    bottom: 0;
    right: 1em;
    cursor: pointer;">
<img alt="Share to Twitter" src="https://cemrekarakas.com/static/img/twitter-100.png" style="width: 5em;"/>
</div>
        </main>
      </div>
      <footer>
        <p>2023 - Created with <a href="https://github.com/cemreefe/SimplyMarkdown">SimplyMarkdown</a></p>
      </footer>
    </div>
  </body>
</html>