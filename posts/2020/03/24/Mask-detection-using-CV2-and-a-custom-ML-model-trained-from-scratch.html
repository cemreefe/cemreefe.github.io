<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cemrekarakas.com/static/css/theme.css">
    <link rel="icon" type="image/png" href="https://emoji.dutl.uk/png/64x64/ðŸ§‘ðŸ»â€ðŸ’».png">
    <title>Mask detection using CV2 and a custom ML model trained from scratch - Cemre's Blog</title>
    
    <meta property="og:title" name="title" content="Mask detection using CV2 and a custom ML model trained from scratch" />
    <meta property="og:image" name="image" content="https://cemrekarakas.com/static/img/default_img.png" />
    <meta property="og:description" name="description" content="People started wearing masks in Istanbul during the coronavirus outbreak. After I realized this, I wanted to know what percentage of people were wearing ma..." />
    <meta property="og:type" content="website" />
    <meta property="og:url" name="url" content="https://cemrekarakas.com/posts/2020/03/24/Mask-detection-using-CV2-and-a-custom-ML-model-trained-from-scratch">
    <meta property="twitter:title" name="title" content="Mask detection using CV2 and a custom ML model trained from scratch" />
    <meta property="twitter:image" name="image" content="https://cemrekarakas.com/static/img/default_img.png" />
    <link rel="canonical" href="https://cemrekarakas.com/posts/2020/03/24/Mask-detection-using-CV2-and-a-custom-ML-model-trained-from-scratch" />
    <meta property="og:pubdate" name="pubdate" content="Tue, 24 Mar 2020 00:00:00 +0000" />

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D53MYFV2RS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D53MYFV2RS');
</script>
<script>
  // Function to handle the click event on headers.
  function handleClick(event) {
      // Get the element's ID.
      const id = this.id;

      // Define the base URL.
      const baseUrl = window.location.href.split('#')[0];

      // Construct the URL with ID.
      const urlWithId = baseUrl + '#' + id;

      // Create a temporary text area element to facilitate copying to the clipboard.
      const textArea = document.createElement('textarea');
      textArea.value = urlWithId;
      document.body.appendChild(textArea);

      // Select and copy the URL with ID to the clipboard.
      textArea.select();
      document.execCommand('copy');

      // Remove the temporary text area element.
      document.body.removeChild(textArea);

      alert("Link copied to clipboard.");
  }

  // Add a DOMContentLoaded event listener to run the code when the document is ready.
  document.addEventListener('DOMContentLoaded', function() {
      // Add a click event listener to the specified header elements (h2, h3, h4).
      document.querySelectorAll('h2, h3, h4').forEach(function(header) {
          header.addEventListener('click', handleClick);
      });
  });
</script>

<p><meta name="twitter:card" content="summary_large_image"/>
<meta content='@cemreefe' name='twitter:site'/>
<meta content='@cemreefe' name='twitter:creator'/></p>
<script>
    // temporary script for applying custom styles
    function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }

    function switchStylesheet(newHref) {
        // Get all current link elements in the head
        const links = document.querySelectorAll('link[rel=stylesheet]');

        // Loop through the link elements and remove them
        links.forEach(link => {
            link.parentNode.removeChild(link);
        });

        // Create a new link element for the new stylesheet
        const newLink = document.createElement('link');
        newLink.rel = 'stylesheet';
        newLink.href = newHref;

        // Append the new link element to the head
        document.head.appendChild(newLink);
    }

    function addStyleParamToLinks(style) {
        const links = document.querySelectorAll('a[href]');
        links.forEach(link => {
            const url = new URL(link.href);
            url.searchParams.set('style', style);
            link.href = url.toString();
        });
    }

    // On page load, check for the 'style' query parameter and apply style
    window.addEventListener('DOMContentLoaded', () => {
        const style = getQueryParam('style');
        if (style) {
            const stylesheetHref = `/static/css/${style}.css`;
            switchStylesheet(stylesheetHref);
            addStyleParamToLinks(style);
        }
    });
</script>
  </head>
  <body>
    <div class="wrapper">
      <div class="content">
        <nav>
          <h3 id="cemres-blog">Cemre's Blog</h3>
<p><a href="/">About</a>
<a href="/blog">Blog</a>
<a href="/contact">Contact</a>
<a href="/archive">Archive</a></p>
<hr />
        </nav>
      </div>
      <div class="content">
        <main>
          
          <div class="categoryTag">
            hobbydev
          </div>
          
          <div class="categoryTag">
            deep learning
          </div>
          
          <div class="categoryTag">
            computer vision
          </div>
          
          <div class="categoryTag">
            coding
          </div>
          
          <h1 id="mask-detection-using-cv2-and-a-custom-ml-model-trained-from-scratch">Mask detection using CV2 and a custom ML model trained from scratch</h1>
<h3 id="situation">Situation</h3>
<p>People started wearing masks in Istanbul during the coronavirus outbreak. After I realized this, I wanted to know what percentage of people were wearing masks and since I had all the time in the world due to schools getting cancelled, I took on this personal project.</p>
<p><img alt="" src="https://cemrekarakas.com/posts/2020/03/24/static/img/projects/mask_data.png" width="85%" / style="max-width:100%"></p>
<p>I used OpenCV to detect people in a video stream provided by Ä°BB (the metropolitan municipality of Istanbul). I saved the people detected in the last minute and when new detections arrived, I compared them with the saved images to avoid duplicates.</p>
<h3 id="shortcomings">Shortcomings</h3>
<p>This was the beginning of Covid-19. So there weren't any models trained to locate/classify surgical masks. </p>
<h3 id="solution-diy">Solution: DIY</h3>
<p>After collecting around 10,000 images, I needed to label them to train my mask detection model. So I wrote a simple GUI annotation tool to label images and save their labels into text files in csv format.</p>
<p>I normalized the data for training by upsampling the number of masked individuals to speed up the learning at the beginning and slowly decreased the magnitude of normalization until I reached the point where I was training with the original dataset.</p>
<p>I wrote a simple script that parses all images from their paths (seperated by dates), predicts labels for all of them and plotting the change in the percentage of masked people in the population.</p>
<p><img alt="" src="https://cemrekarakas.com/posts/2020/03/24/static/img/projects/mask_gui.png" width="60%" / style="max-width:100%"></p>
<p>The project, although time-consuming, was a lot of fun and it has helped me gain a good amount of hands-on practice. I am also quite happy with the data I was able to get from this project.</p>
<p>See my <a href="https://github.com/cemreefe/are-you-wearing-your-mask">github repo</a> for the implementation.</p>
<div class="commentbox"></div>
<script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
<script>commentBox('5631895295492096-proj')</script>

<div onclick="{window.open('https://twitter.com/intent/tweet?url=Check out this \''+ document.getElementsByTagName('h1')[0].innerHTML +'\' article on Cemre\'s Blog: '+window.location.href, '_blank');}" 
    style="
    position: fixed;
    bottom: 0;
    right: 1em;
    cursor: pointer;">
  <img src="https://cemrekarakas.com/posts/2020/03/24/static/img/twitter-100.png" style="width: 5em;" alt="Share to Twitter" style="max-width:100%">
</div>
        </main>
      </div>
      <footer>
        <p>2023 - Created with <a href="https://github.com/cemreefe/SimplyMarkdown">SimplyMarkdown</a></p>
<script>
  document.addEventListener('DOMContentLoaded', function() {
      // Get the current page's URL
      var currentPageURL = window.location.href;

      // Select all anchor elements on the page
      var links = document.querySelectorAll('a');

      // Loop through each link
      links.forEach(function(link) {
          // Check if the href of the link matches the current page's URL
          if (link.href === currentPageURL) {
              // Change the color of the link to red
              link.style.color = 'red';
          }
      });
  });
</script>
      </footer>
    </div>
  </body>
</html>