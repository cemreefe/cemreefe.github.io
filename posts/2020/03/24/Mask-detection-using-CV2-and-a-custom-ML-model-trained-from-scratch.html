<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="deep learning
hobbydev
coding">
    <link rel="stylesheet" href="https://cemrekarakas.com/static/css/theme.css">
    <link rel="icon" type="image/png" href="https://emoji.dutl.uk/png/64x64/🧑🏻‍💻.png">
    <title>Mask detection using CV2 and a custom ML model trained from scratch | Cemre's Blog</title>
    
    <meta property="og:image" content="https://cemrekarakas.com/static/img/default_img.png">
    <meta name="twitter:image" content="https://cemrekarakas.com/static/img/default_img.png">
    <meta name="twitter:title" content="Mask detection using CV2 and a custom ML model trained from scratch">
    
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D53MYFV2RS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D53MYFV2RS');
</script>
<style>
  @font-face {
    font-family: 'Montserrat';
    src: url('/static/fonts/Montserrat-VariableFont_wght.ttf') format('truetype');
  }

  @font-face {
    font-family: 'Fira Sans';
    src: url('/static/fonts/FiraSans-Bold.ttf') format('truetype');
  }
  body {
    font-family: Montserrat;
  }
  h1, h2, h3 {
    font-family: Fira Sans;
  }
</style>

<script>
  // Function to handle the click event on headers.
  function handleClick(event) {
      // Get the element's ID.
      const id = this.id;

      // Define the base URL.
      const baseUrl = window.location.href.split('#')[0];

      // Construct the URL with ID.
      const urlWithId = baseUrl + '#' + id;

      // Create a temporary text area element to facilitate copying to the clipboard.
      const textArea = document.createElement('textarea');
      textArea.value = urlWithId;
      document.body.appendChild(textArea);

      // Select and copy the URL with ID to the clipboard.
      textArea.select();
      document.execCommand('copy');

      // Remove the temporary text area element.
      document.body.removeChild(textArea);

      // Provide a visual cue to indicate that the URL with ID has been copied.
      this.style.backgroundColor = 'lightgreen';
      alert("Copied to clipboard.");

      // Reset the background color after a short delay (you can adjust the delay).
      setTimeout(function() {
          event.target.style.transition = 'background-color 0.5s'; // Add a transition
          event.target.style.backgroundColor = '';
      }, 1000);
  }

  // Add a DOMContentLoaded event listener to run the code when the document is ready.
  document.addEventListener('DOMContentLoaded', function() {
      // Add a click event listener to the specified header elements (h1, h2, h3, h4).
      document.querySelectorAll('h1, h2, h3, h4').forEach(function(header) {
          header.addEventListener('click', handleClick);
      });
  });
</script>

<p><meta name="twitter:card" content="summary_large_image"/>
<meta content='@cemreefe' name='twitter:site'/>
<meta content='@cemreefe' name='twitter:creator'/></p>
  </head>
  <body>
    <div class="wrapper">
      <div class="content">
        <nav>
          <p><img alt="avatar" class="avatar" onclick="alert('ouch!')" src="https://i.ibb.co/xS6pmT8/Screenshot-2023-08-21-at-23-14-22%20.png" /></p>
<h3 id="cemres-blog">Cemre's Blog</h3>
<p><a href="/">About</a>
<a href="/blog">Blog</a>
<a href="/contact">Contact</a></p>
<hr />
        </nav>
      </div>
      <div class="content">
        <main>
          <h2 id="mask-detection-using-cv2-and-a-custom-ml-model-trained-from-scratch">Mask detection using CV2 and a custom ML model trained from scratch</h2>
<p>
<div>
<div class="categoryTag">deep learning</div>
<div class="categoryTag">hobbydev</div>
<div class="categoryTag">coding</div>
</div>
</p>
<h3 id="situation">Situation</h3>
<p>People started wearing masks in Istanbul during the coronavirus outbreak. After I realized this, I wanted to know what percentage of people were wearing masks and since I had all the time in the world due to schools getting cancelled, I took on this personal project.</p>
<p><img alt="" src="/static/img/projects/mask_data.png" width="85%" /></p>
<p>I used OpenCV to detect people in a video stream provided by İBB (the metropolitan municipality of Istanbul). I saved the people detected in the last minute and when new detections arrived, I compared them with the saved images to avoid duplicates.</p>
<h3 id="shortcomings">Shortcomings</h3>
<p>This was the beginning of Covid-19. So there weren't any models trained to locate/classify surgical masks. </p>
<h3 id="solution-diy">Solution: DIY</h3>
<p>After collecting around 10,000 images, I needed to label them to train my mask detection model. So I wrote a simple GUI annotation tool to label images and save their labels into text files in csv format.</p>
<p>I normalized the data for training by upsampling the number of masked individuals to speed up the learning at the beginning and slowly decreased the magnitude of normalization until I reached the point where I was training with the original dataset.</p>
<p>I wrote a simple script that parses all images from their paths (seperated by dates), predicts labels for all of them and plotting the change in the percentage of masked people in the population.</p>
<p><img alt="" src="/static/img/projects/mask_gui.png" width="60%" /></p>
<p>The project, although time-consuming, was a lot of fun and it has helped me gain a good amount of hands-on practice. I am also quite happy with the data I was able to get from this project.</p>
<p>See my <a href="https://github.com/cemreefe/are-you-wearing-your-mask">github repo</a> for the implementation.</p>
<div class="commentbox"></div>
<script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
<script>commentBox('5631895295492096-proj')</script>

<div onclick="{window.open('https://twitter.com/intent/tweet?url=Check out this \''+ document.getElementsByTagName('h1')[0].innerHTML +'\' article on Cemre\'s Blog: '+window.location.href, '_blank');}" 
    style="
    position: fixed;
    bottom: 0;
    right: 1em;
    cursor: pointer;">
  <img src="https://cdn.iconscout.com/icon/free/png-256/twitter-share-button-3289861-2758559.png" style="width: 5em;" alt="Share to Twitter">
</div>
        </main>
      </div>
      <footer>
        <p>2023 - Created with <a href="https://github.com/cemreefe/SimplyMarkdown">SimplyMarkdown</a></p>
      </footer>
    </div>
  </body>
</html>