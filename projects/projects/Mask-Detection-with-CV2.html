<!DOCTYPE html>
<html lang="https://cemrekarakas.com">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="People started wearing masks in Istanbul during the coronavirus outbreak. After I realized this, I wanted to know what percentage of people were wearing masks and since I had all the time in the world due to schools getting cancelled, I took on this personal project.">
    <link rel="stylesheet" href="https://cemrekarakas.com/static/css/theme.css">
    <link rel="icon" type="image/png" href="https://emoji.dutl.uk/png/32x32/🍄.png">
    <title>Mask detection using cv2 and training an ML model from scratch | Cemre's Blog</title>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D53MYFV2RS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D53MYFV2RS');
</script>
<style>
  @font-face {
    font-family: 'Montserrat';
    src: url('/static/fonts/Montserrat-VariableFont_wght.ttf') format('truetype');
  }

  @font-face {
    font-family: 'Fira Sans';
    src: url('/static/fonts/FiraSans-Bold.ttf') format('truetype');
  }
  body {
    font-family: Montserrat;
  }
  h1, h2, h3 {
    font-family: Fira Sans;
  }
</style>
<meta property="og:image" content="https://cemrekarakas.com/static/img/default_img.png">
		<meta name="twitter:image" content="https://cemrekarakas.com/static/img/default_img.png">
  </head>
  <body>
    <div class="wrapper">
      <div class="content">
        <nav>
          <p><img alt="avatar" hidden="hidden" onclick="alert('ouch!')" src="https://avatars.githubusercontent.com/u/44120900" style="width:20%; max-width:500px; margin-bottom:0; border-radius:50%" /></p>
<p><strong>Cemre Karakas</strong>'s Blog</p>
<p><a href="/">About</a>
<a href="/blog/blog">Blog</a>
<a href="/contact">Contact</a>
<a href="/projects/projects">Projects</a>
<a href="http://dutl.uk/">🌿</a></p>
<hr />
        </nav>
      </div>
      <div class="content">
        <main>
          <h1 id="mask-detection-using-cv2-and-training-an-ml-model-from-scratch">Mask detection using cv2 and training an ML model from scratch</h1>
<p>People started wearing masks in Istanbul during the coronavirus outbreak. After I realized this, I wanted to know what percentage of people were wearing masks and since I had all the time in the world due to schools getting cancelled, I took on this personal project.</p>
<p><img alt="" src="/static/img/projects/mask_data.png" width="85%" /></p>
<p>I used OpenCV to detect people in a video stream provided by İBB (the metropolitan municipality of Istanbul). I saved the people detected in the last minute and when new detections arrived, I compared them with the saved images to avoid duplicates.</p>
<p>After collecting around 10,000 images, I needed to label them to train my mask detection model. So I wrote a simple GUI annotation tool to label images and save their labels into text files in csv format.</p>
<p>I normalized the data for training by upsampling the number of masked individuals to speed up the learning at the beginning and slowly decreased the magnitude of normalization until I reached the point where I was training with the original dataset.</p>
<p>I wrote a simple script that parses all images from their paths (seperated by dates), predicts labels for all of them and plotting the change in the percentage of masked people in the population.</p>
<p><img alt="" src="/static/img/projects/mask_gui.png" width="60%" /></p>
<p>The project, although time-consuming, was a lot of fun and it has helped me gain a good amount of hands-on practice. I am also quite happy with the data I was able to get from this project.</p>
<p>See my <a href="https://github.com/cemreefe/are-you-wearing-your-mask">github repo</a> for the implementation.</p>
        </main>
      </div>
    </div>
    <footer>
      <p>2023 - Created with <a href="https://github.com/cemreefe/SimplyMarkdown">SimplyMarkdown</a></p>
    </footer>
  </body>
</html>